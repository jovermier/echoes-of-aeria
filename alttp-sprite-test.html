<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ALTTP Sprite Test - Echoes of Aeria</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            background: #2e2e2e;
            color: white;
            font-family: 'Courier New', monospace;
        }
        
        .sprite-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin: 20px 0;
        }
        
        .sprite-demo {
            border: 2px solid #555;
            padding: 10px;
            background: #1a1a1a;
            border-radius: 8px;
        }
        
        .sprite-demo h3 {
            margin: 0 0 10px 0;
            color: #4CAF50;
        }
        
        canvas {
            image-rendering: pixelated;
            image-rendering: -moz-crisp-edges;
            image-rendering: crisp-edges;
            border: 1px solid #333;
            background: #f0f0f0;
        }
        
        .controls {
            margin-top: 10px;
        }
        
        .controls button {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 5px 10px;
            margin-right: 5px;
            cursor: pointer;
            border-radius: 4px;
            font-size: 12px;
        }
        
        .controls button:hover {
            background: #5CBF60;
        }
    </style>
</head>
<body>
    <h1>üõ°Ô∏è ALTTP Sprite System Test</h1>
    <p>Testing the A Link to the Past inspired sprite system for Echoes of Aeria</p>
    
    <div class="sprite-container">
        <div class="sprite-demo">
            <h3>Link-inspired Player</h3>
            <canvas id="player-sprite" width="256" height="192"></canvas>
            <div class="controls">
                <button onclick="animatePlayer()">Animate Walking</button>
                <button onclick="showPlayerAttack()">Show Attack</button>
            </div>
        </div>
        
        <div class="sprite-demo">
            <h3>Keeper NPC</h3>
            <canvas id="npc-sprite" width="256" height="192"></canvas>
            <div class="controls">
                <button onclick="animateNPC()">Animate Idle</button>
            </div>
        </div>
        
        <div class="sprite-demo">
            <h3>Goblin Enemy</h3>
            <canvas id="enemy-sprite" width="256" height="192"></canvas>
            <div class="controls">
                <button onclick="animateEnemy()">Animate Walking</button>
            </div>
        </div>
        
        <div class="sprite-demo">
            <h3>Environment Tiles</h3>
            <canvas id="tile-demo" width="256" height="192"></canvas>
            <div class="controls">
                <button onclick="showTiles()">Show Various Tiles</button>
            </div>
        </div>
    </div>
    
    <script type="module">
        // Import our ALTTP palette constants
        const ALTTP_PALETTE = {
            LINK_TUNIC_GREEN: '#008000',
            LINK_TUNIC_DARK: '#005000',
            LINK_TUNIC_LIGHT: '#40c040',
            LINK_SKIN_TONE: '#ffcc99',
            LINK_SKIN_SHADOW: '#cc9966',
            LINK_HAIR_BROWN: '#8b4513',
            LINK_CAP_GREEN: '#006000',
            LINK_BOOTS_BROWN: '#654321',
            BLACK: '#000000',
            WHITE: '#ffffff',
            ROBE_PURPLE: '#9C27B0',
            GOBLIN_GREEN: '#4a7c4a',
            GOBLIN_DARK: '#2d5c2d',
            ENEMY_RED_EYES: '#ff0000',
            WOOD_BROWN: '#8B4513'
        };

        // Simplified sprite manager for testing
        class TestSpriteManager {
            constructor() {
                this.sprites = {};
                this.generateSprites();
            }

            generateSprites() {
                this.sprites.player = this.generateLinkSprite();
                this.sprites.npc = this.generateNPCSprite();
                this.sprites.enemy = this.generateEnemySprite();
            }

            generateLinkSprite() {
                const canvas = document.createElement('canvas');
                canvas.width = 64; // 4 directions √ó 16 pixels
                canvas.height = 48; // 3 frames √ó 16 pixels
                const ctx = canvas.getContext('2d');
                ctx.imageSmoothingEnabled = false;

                const directions = ['down', 'up', 'left', 'right'];
                
                directions.forEach((dir, dirIndex) => {
                    for (let frame = 0; frame < 3; frame++) {
                        const x = dirIndex * 16;
                        const y = frame * 16;
                        
                        // Body (tunic)
                        ctx.fillStyle = ALTTP_PALETTE.LINK_TUNIC_GREEN;
                        ctx.fillRect(x + 4, y + 7, 8, 7);
                        
                        // Tunic shading
                        ctx.fillStyle = ALTTP_PALETTE.LINK_TUNIC_DARK;
                        ctx.fillRect(x + 4, y + 7, 1, 7);
                        ctx.fillRect(x + 4, y + 13, 8, 1);
                        
                        // Tunic highlights
                        ctx.fillStyle = ALTTP_PALETTE.LINK_TUNIC_LIGHT;
                        ctx.fillRect(x + 5, y + 8, 1, 2);
                        ctx.fillRect(x + 10, y + 8, 1, 2);
                        
                        // Head
                        ctx.fillStyle = ALTTP_PALETTE.LINK_SKIN_TONE;
                        ctx.fillRect(x + 6, y + 3, 4, 4);
                        
                        // Head shading
                        ctx.fillStyle = ALTTP_PALETTE.LINK_SKIN_SHADOW;
                        ctx.fillRect(x + 6, y + 6, 4, 1);
                        
                        // Cap
                        ctx.fillStyle = ALTTP_PALETTE.LINK_CAP_GREEN;
                        ctx.fillRect(x + 6, y + 2, 4, 2);
                        
                        // Hair
                        ctx.fillStyle = ALTTP_PALETTE.LINK_HAIR_BROWN;
                        if (dir === 'down' || dir === 'up') {
                            ctx.fillRect(x + 5, y + 3, 1, 2);
                            ctx.fillRect(x + 10, y + 3, 1, 2);
                        } else if (dir === 'left') {
                            ctx.fillRect(x + 10, y + 3, 1, 2);
                        } else if (dir === 'right') {
                            ctx.fillRect(x + 5, y + 3, 1, 2);
                        }
                        
                        // Eyes
                        ctx.fillStyle = ALTTP_PALETTE.BLACK;
                        if (dir === 'down') {
                            ctx.fillRect(x + 7, y + 4, 1, 1);
                            ctx.fillRect(x + 8, y + 4, 1, 1);
                        } else if (dir === 'left') {
                            ctx.fillRect(x + 7, y + 4, 1, 1);
                        } else if (dir === 'right') {
                            ctx.fillRect(x + 8, y + 4, 1, 1);
                        }
                        
                        // Arms
                        ctx.fillStyle = ALTTP_PALETTE.LINK_TUNIC_GREEN;
                        if (dir === 'left' || dir === 'right') {
                            const armX = dir === 'left' ? x + 3 : x + 12;
                            const armOffset = frame === 1 ? 1 : 0;
                            ctx.fillRect(armX, y + 8 + armOffset, 1, 4);
                        } else {
                            ctx.fillRect(x + 3, y + 8, 1, 3);
                            ctx.fillRect(x + 12, y + 8, 1, 3);
                        }
                        
                        // Legs
                        ctx.fillStyle = ALTTP_PALETTE.LINK_TUNIC_GREEN;
                        const legOffset = frame === 1 ? 0 : (frame === 0 ? -1 : 1);
                        ctx.fillRect(x + 5, y + 14, 2, 1);
                        ctx.fillRect(x + 9, y + 14, 2, 1);
                        
                        // Boots
                        ctx.fillStyle = ALTTP_PALETTE.LINK_BOOTS_BROWN;
                        ctx.fillRect(x + 5 + (frame === 1 ? 0 : legOffset), y + 15, 2, 1);
                        ctx.fillRect(x + 9 + (frame === 1 ? 0 : -legOffset), y + 15, 2, 1);
                    }
                });

                return canvas;
            }

            generateNPCSprite() {
                const canvas = document.createElement('canvas');
                canvas.width = 64;
                canvas.height = 48;
                const ctx = canvas.getContext('2d');
                ctx.imageSmoothingEnabled = false;

                const directions = ['down', 'up', 'left', 'right'];
                
                directions.forEach((dir, dirIndex) => {
                    for (let frame = 0; frame < 3; frame++) {
                        const x = dirIndex * 16;
                        const y = frame * 16;
                        
                        // Robe body
                        ctx.fillStyle = ALTTP_PALETTE.ROBE_PURPLE;
                        ctx.fillRect(x + 3, y + 6, 10, 9);
                        
                        // Robe shading
                        ctx.fillStyle = this.darkenColor(ALTTP_PALETTE.ROBE_PURPLE, 0.3);
                        ctx.fillRect(x + 3, y + 6, 2, 9);
                        ctx.fillRect(x + 3, y + 13, 10, 2);
                        
                        // Hood/head
                        ctx.fillStyle = this.darkenColor(ALTTP_PALETTE.ROBE_PURPLE, 0.2);
                        ctx.fillRect(x + 5, y + 2, 6, 4);
                        
                        // Face
                        ctx.fillStyle = ALTTP_PALETTE.LINK_SKIN_TONE;
                        ctx.fillRect(x + 6, y + 3, 4, 3);
                        
                        // Eyes
                        ctx.fillStyle = ALTTP_PALETTE.BLACK;
                        if (dir === 'down') {
                            ctx.fillRect(x + 7, y + 4, 1, 1);
                            ctx.fillRect(x + 8, y + 4, 1, 1);
                        } else if (dir === 'left') {
                            ctx.fillRect(x + 7, y + 4, 1, 1);
                        } else if (dir === 'right') {
                            ctx.fillRect(x + 8, y + 4, 1, 1);
                        }
                    }
                });

                return canvas;
            }

            generateEnemySprite() {
                const canvas = document.createElement('canvas');
                canvas.width = 64;
                canvas.height = 48;
                const ctx = canvas.getContext('2d');
                ctx.imageSmoothingEnabled = false;

                const directions = ['down', 'up', 'left', 'right'];
                
                directions.forEach((dir, dirIndex) => {
                    for (let frame = 0; frame < 3; frame++) {
                        const x = dirIndex * 16;
                        const y = frame * 16;
                        
                        // Body
                        ctx.fillStyle = ALTTP_PALETTE.WOOD_BROWN;
                        ctx.fillRect(x + 4, y + 8, 8, 6);
                        
                        // Head
                        ctx.fillStyle = ALTTP_PALETTE.GOBLIN_GREEN;
                        ctx.fillRect(x + 5, y + 3, 6, 5);
                        
                        // Head shading
                        ctx.fillStyle = ALTTP_PALETTE.GOBLIN_DARK;
                        ctx.fillRect(x + 5, y + 3, 1, 5);
                        ctx.fillRect(x + 5, y + 7, 6, 1);
                        
                        // Eyes (red)
                        ctx.fillStyle = ALTTP_PALETTE.ENEMY_RED_EYES;
                        if (dir === 'down') {
                            ctx.fillRect(x + 6, y + 5, 1, 1);
                            ctx.fillRect(x + 9, y + 5, 1, 1);
                        } else if (dir === 'left') {
                            ctx.fillRect(x + 6, y + 5, 1, 1);
                        } else if (dir === 'right') {
                            ctx.fillRect(x + 9, y + 5, 1, 1);
                        }
                        
                        // Legs
                        ctx.fillStyle = ALTTP_PALETTE.GOBLIN_GREEN;
                        const legOffset = frame === 1 ? 1 : 0;
                        ctx.fillRect(x + 5, y + 14 + legOffset, 2, 1);
                        ctx.fillRect(x + 9, y + 14 - legOffset, 2, 1);
                    }
                });

                return canvas;
            }

            darkenColor(color, factor) {
                const hex = color.replace('#', '');
                const r = Math.max(0, parseInt(hex.substr(0, 2), 16) * (1 - factor));
                const g = Math.max(0, parseInt(hex.substr(2, 2), 16) * (1 - factor));
                const b = Math.max(0, parseInt(hex.substr(4, 2), 16) * (1 - factor));
                return `#${Math.floor(r).toString(16).padStart(2, '0')}${Math.floor(g).toString(16).padStart(2, '0')}${Math.floor(b).toString(16).padStart(2, '0')}`;
            }
        }

        // Initialize sprite manager
        const spriteManager = new TestSpriteManager();

        // Animation functions
        let animations = {};

        function drawSprite(canvasId, sprite, scale = 4) {
            const canvas = document.getElementById(canvasId);
            const ctx = canvas.getContext('2d');
            ctx.imageSmoothingEnabled = false;
            
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.drawImage(sprite, 0, 0, sprite.width * scale, sprite.height * scale);
        }

        function animateWalkCycle(canvasId, sprite, direction, scale = 4) {
            const canvas = document.getElementById(canvasId);
            const ctx = canvas.getContext('2d');
            let frame = 0;
            const directionIndex = ['down', 'up', 'left', 'right'].indexOf(direction);
            
            clearInterval(animations[canvasId]);
            animations[canvasId] = setInterval(() => {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                const sourceX = directionIndex * 16;
                const sourceY = frame * 16;
                
                ctx.drawImage(sprite, sourceX, sourceY, 16, 16, 0, 0, 16 * scale, 16 * scale);
                
                frame = (frame + 1) % 3;
            }, 200);
        }

        // Global functions for buttons
        window.animatePlayer = () => animateWalkCycle('player-sprite', spriteManager.sprites.player, 'down');
        window.showPlayerAttack = () => drawSprite('player-sprite', spriteManager.sprites.player);
        window.animateNPC = () => animateWalkCycle('npc-sprite', spriteManager.sprites.npc, 'down');
        window.animateEnemy = () => animateWalkCycle('enemy-sprite', spriteManager.sprites.enemy, 'down');
        
        window.showTiles = () => {
            const canvas = document.getElementById('tile-demo');
            const ctx = canvas.getContext('2d');
            ctx.imageSmoothingEnabled = false;
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Draw some sample tiles
            const tileSize = 16;
            const scale = 4;
            
            // Grass tile
            ctx.fillStyle = '#4A8B3B';
            ctx.fillRect(0, 0, tileSize * scale, tileSize * scale);
            ctx.fillStyle = '#5a8c69';
            ctx.fillRect(2 * scale, 1 * scale, 2 * scale, 1 * scale);
            ctx.fillRect(6 * scale, 0 * scale, 3 * scale, 1 * scale);
            
            // Water tile
            ctx.fillStyle = '#1E90FF';
            ctx.fillRect(tileSize * scale, 0, tileSize * scale, tileSize * scale);
            ctx.fillStyle = '#42a5f5';
            ctx.fillRect((tileSize + 3) * scale, 3 * scale, 1 * scale, 1 * scale);
            ctx.fillRect((tileSize + 8) * scale, 2 * scale, 2 * scale, 1 * scale);
            
            // Stone tile
            ctx.fillStyle = '#696969';
            ctx.fillRect(tileSize * 2 * scale, 0, tileSize * scale, tileSize * scale);
            ctx.fillStyle = '#757575';
            ctx.fillRect((tileSize * 2 + 2) * scale, 0, 1 * scale, tileSize * scale);
            
            // Add labels
            ctx.fillStyle = 'white';
            ctx.font = '12px monospace';
            ctx.fillText('Grass', 0, tileSize * scale + 20);
            ctx.fillText('Water', tileSize * scale, tileSize * scale + 20);
            ctx.fillText('Stone', tileSize * 2 * scale, tileSize * scale + 20);
        };

        // Initialize displays
        drawSprite('player-sprite', spriteManager.sprites.player);
        drawSprite('npc-sprite', spriteManager.sprites.npc);
        drawSprite('enemy-sprite', spriteManager.sprites.enemy);
        showTiles();
    </script>
</body>
</html>